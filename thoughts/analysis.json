{
  "subjects": [
    {
      "domain": "aws",
      "kind": "EC2Instance",
      "id": "i-0a93117c7575b6d54",
      "role": "source"
    },
    {
      "domain": "aws",
      "kind": "EC2Instance",
      "id": "i-0136d3233f0ef1924",
      "role": "destination"
    }
  ],
  "resources": [
    {
      "kind": "ec2Instance",
      "properties": {
        "id": "i-0a93117c7575b6d54",
        "name": "abc-instance",
        "state": "running",
        "networkInterfaceAttachments": [
          {
            "id": "attach-203409283402948",
            "elasticNetworkInterfaceID": "eni-082b267adf0bd1cdd",
            "deviceName": "eth0"
          }
        ]
      }
    },
    {
      "kind": "elasticNetworkInterface",
      "properties": {
        "id": "eni-082b267adf0bd1cdd",
        "attachmentID": "eni-attach-06bb378b2ee2ec435",
        "subnetID": "subnet-672b7100",
        "vpcID": "vpc-d32e58a9",
        "privateIPAddress": "10.20.30.40",
        "securityGroupIDs": [
          "sg-2f280072"
        ]
      }
    },
    {
      "kind": "awsVPCSubnet",
      "id": "subnet-672b7100",
      "properties": {
        "vpcID": "vpc-d32e58a9",
        "networkACL": "acl-b8ba63c5",
        "routeTable": "rtb-f5af528b"
      }
    },
    {
      "kind": "awsVPC",
      "id": "vpc-d32e58a9",
      "properties": {
        "ipv4CIDR": "172.31.0.0/16"
      }
    },
    {
      "kind": "awsVPCNetworkACL",
      "id": "acl-b8ba63c5",
      "properties": {
        "rules": {
          "inbound": [
            {
              "priority": "100",
              "protocol": "-1",
              "source": "0.0.0.0/0",
              "effect": "allow"
            }
          ],
          "outbound": [
            {
              "priority": "100",
              "protocol": "-1",
              "destination": "0.0.0.0/0",
              "effect": "allow"
            }
          ]
        }
      }
    },
    {
      "kind": "awsVPCRouteTable",
      "id": "rtb-f5af528b",
      "properties": {
        "routes": [
          {
            "destination": "172.31.0.0/16",
            "target": {
              "kind": "local"
            },
            "status": "active",
            "propagated": false
          },
          {
            "destination": "0.0.0.0/0",
            "target": {
              "kind": "awsVPCInternetGateway",
              "value": "igw-b97aa0c2"
            },
            "status": "active",
            "propagated": false
          }
        ]
      }
    },
    {
      "kind": "securityGroup",
      "id": "sg-2f280072",
      "properties": {
        "name": "my-security-group",
        "groupName": "my-security-group",
        "vpcID": "vpc-d32e58a9",
        "rules": {
          "inbound": [
            {
              "protocol": "-1",
              "source": {
                "kind": "securityGroupReference",
                "value": "sg-2f280072"
              },
              "effect": {
                "kind": "ports",
                "properties": {
                  "ports": [
                    "80",
                    "443",
                    "1000-1024"
                  ]
                }
              }
            }
          ],
          "outbound": [
            {
              "protocol": "-1",
              "destination": {
                "kind": "ipAddressRange",
                "value": "0.0.0.0/0"
              },
              "effect": {
                "kind": "all"
              }
            }
          ]
        }
      }
    }
  ],
  "networkVectors": [
    {
      "id": "3ac60ec5-af1e-4cc7-88b4-e4bde90acd49",
      "source": {
        "ipAddress": {
          "IP": "172.31.0.8",
          "Mask": "//8AAA=="
        },
        "lineage": [
          {
            "domain": "aws",
            "kind": "ElasticNetworkInterface",
            "id": "eni-0f47c416a3438e5ea"
          },
          {
            "domain": "aws",
            "kind": "EC2Instance",
            "id": "i-0a93117c7575b6d54"
          }
        ]
      },
      "destination": {
        "ipAddress": {
          "IP": "172.31.0.122",
          "Mask": "//8AAA=="
        },
        "lineage": [
          {
            "domain": "aws",
            "kind": "ElasticNetworkInterface",
            "id": "eni-082b267adf0bd1cdd"
          },
          {
            "domain": "aws",
            "kind": "EC2Instance",
            "id": "i-0136d3233f0ef1924"
          }
        ]
      },
      "factors": [
        {
          "kind": "InstanceState",
          "associatedRole": "source",
          "resource": {
            "domain": "aws",
            "kind": "EC2Instance",
            "id": "i-0a93117c7575b6d54"
          },
          "trafficContentSet": [
            {
              "protocol": -1
            }
          ]
        },
        {
          "kind": "InstanceState",
          "associatedRole": "destination",
          "resource": {
            "domain": "aws",
            "kind": "EC2Instance",
            "id": "i-0136d3233f0ef1924"
          },
          "trafficContentSet": [
          ]
        },
        {
          "kind": "SecurityGroupRule",
          "associatedRole": "source",
          "resource": {
            "domain": "aws",
            "kind": "SecurityGroup",
            "id": "sg-2f280072"
          },
          "trafficContentSet": [
            {
              "protocol": 6,
              "ports": [
                "80",
                "1024-2000"
              ]
            }
          ],
          "properties": {
            "ruleIndex": 0,
            "matchBasis": "IPAddress",
            "matchValue": "172.31.1.5"
          }
        },
        {
          "kind": "SecurityGroupRuleAbsence",
          "associatedRole": "destination",
          "resource": {
            "domain": "aws",
            "kind": "SecurityGroup",
            "id": "sg-2f28ff83"
          },
          "trafficContentSet": [
          ]
        }
      ]
    }
  ],
  "results": [
    {
      "networkVectorID": "3ac60ec5-af1e-4cc7-88b4-e4bde90acd49",
      "trafficContent": {
        "tcp": [
          "80",
          "443"
        ],
        "udp": [
          "53"
        ],
        "customProtocols": [
          "50",
          "100"
        ]
      }
    }
  ]
}

